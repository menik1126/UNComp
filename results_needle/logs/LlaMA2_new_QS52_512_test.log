/home/avnet/miniconda3/envs/uncomp/lib/python3.10/site-packages/huggingface_hub/file_download.py:795: FutureWarning: `resume_download` is deprecated and will be removed in version 1.0.0. Downloads always resume when possible. If you want to force a new download, use `force_download=True`.
  warnings.warn(
loading from meta-llama/Llama-2-7b-chat-hf


Starting Needle In A Haystack Testing...
- Model: meta-llama/Llama-2-7b-chat-hf
- Context Lengths: 11, Min: 3000, Max: 4000
- Document Depths: 10, Min: 0%, Max: 100%
- Needle: The best thing to do in San Francisco is eat a sandwich and sit in Dolores Park on a sunny day.



Searching existing results at results_needle/results/LlaMA2_new_QS52_512_test
result does not exist, testing
insertion at 0
Traceback (most recent call last):
  File "/home/avnet/mount_disk/sjh/UNComp/run_needle_in_haystack.py", line 627, in <module>
    ht.start_test(args)
  File "/home/avnet/mount_disk/sjh/UNComp/run_needle_in_haystack.py", line 510, in start_test
    self.run_test(args)
  File "/home/avnet/mount_disk/sjh/UNComp/run_needle_in_haystack.py", line 238, in run_test
    task = self.bound_evaluate_and_log(context_length, depth_percent)
  File "/home/avnet/mount_disk/sjh/UNComp/run_needle_in_haystack.py", line 229, in bound_evaluate_and_log
    self.evaluate_and_log(*args)
  File "/home/avnet/mount_disk/sjh/UNComp/run_needle_in_haystack.py", line 287, in evaluate_and_log
    input_ids = prompt['input_ids'].to(self.model_to_test.device)
AttributeError: 'LLMNeedleHaystackTester' object has no attribute 'model_to_test'
